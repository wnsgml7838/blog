<!-- 코드 비교 컴포넌트 (Before/After) -->
<!-- 사용법: {% include code-comparison.html title="리팩토링 예시" before_lang="javascript" after_lang="javascript" %} -->

{%- assign title = include.title -%}
{%- assign before_lang = include.before_lang | default: 'javascript' -%}
{%- assign after_lang = include.after_lang | default: before_lang -%}
{%- assign before_title = include.before_title | default: 'Before' -%}
{%- assign after_title = include.after_title | default: 'After' -%}

<div class="code-comparison-container">
  {% if title %}
  <h3 class="code-comparison-title">{{ title }}</h3>
  {% endif %}
  
  <div class="code-comparison-wrapper">
    <!-- Before 코드 -->
    <div class="code-comparison-panel before-panel">
      <div class="comparison-header">
        <h4 class="comparison-label before-label">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"/>
          </svg>
          {{ before_title }}
        </h4>
        <span class="language-badge before-badge">{{ before_lang }}</span>
      </div>
      
      <div class="comparison-code">
        {% include code-block.html language=before_lang content=include.before copy=false line_numbers=true %}
      </div>
      
      {% if include.before_issues %}
      <div class="code-issues">
        <h5>⚠️ 문제점</h5>
        <ul>
          {% for issue in include.before_issues %}
          <li class="issue-item">{{ issue }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    </div>
    
    <!-- 화살표 -->
    <div class="comparison-arrow">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
        <path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z"/>
      </svg>
    </div>
    
    <!-- After 코드 -->
    <div class="code-comparison-panel after-panel">
      <div class="comparison-header">
        <h4 class="comparison-label after-label">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"/>
          </svg>
          {{ after_title }}
        </h4>
        <span class="language-badge after-badge">{{ after_lang }}</span>
      </div>
      
      <div class="comparison-code">
        {% include code-block.html language=after_lang content=include.after copy=true line_numbers=true %}
      </div>
      
      {% if include.after_improvements %}
      <div class="code-improvements">
        <h5>✅ 개선사항</h5>
        <ul>
          {% for improvement in include.after_improvements %}
          <li class="improvement-item">{{ improvement }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    </div>
  </div>
  
  {% if include.explanation %}
  <div class="comparison-explanation">
    <h4>💡 설명</h4>
    <p>{{ include.explanation }}</p>
  </div>
  {% endif %}
  
  {% if include.metrics %}
  <div class="comparison-metrics">
    <h4>📊 성능 지표</h4>
    <div class="metrics-grid">
      {% for metric in include.metrics %}
      <div class="metric-item">
        <div class="metric-label">{{ metric.name }}</div>
        <div class="metric-values">
          <span class="metric-before">{{ metric.before }}</span>
          <span class="metric-arrow">→</span>
          <span class="metric-after">{{ metric.after }}</span>
        </div>
        {% if metric.improvement %}
        <div class="metric-improvement">{{ metric.improvement }}</div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</div>